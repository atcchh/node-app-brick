var rest 	 = require('restler'),
	fs   	 = require('fs'),
	filename = process.argv[2];
var startTime = new Date();
rest.post('http://api.ruokuai.com/create.json', {
	multipart: true,
	data: {
		'username': 'test10002',
		'password': '2F4EFC577084BB20B8C30D38F6458A27',
		'typeid':'3040',
		'softid': '6865',
		'softkey': 'c009a96f01a622653fea46e324a3d4ce',
		'image': rest.file(filename, null, fs.statSync(filename).size, null, 'image/gif') // filename: 抓取回来的码证码文件
	},
	headers: { 
		'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:24.0) Gecko/20100101 Firefox/24.0',
		'Content-Type' : 'application/x-www-form-urlencoded' 
	}
}).on('complete', function(data) {
	var captcha = JSON.parse(data);
	console.log('Captcha Encoded.');
	console.log(captcha);
	var endTime = new Date();
	console.log(endTime.getTime() - startTime.getTime());
});
