var spawn = require('./child_process_promise.js').spawn;


function Command(command, args) {
	this.command = command;
	this.args = args;
	// console.log(command);
	// console.log("------------------------------------");
	// console.log(args);
}
Command.prototype.run = function() {
	var taskName = process.pid;
	return spawn(this.command, this.args)
	    .progress(function(childProcess) {
	        taskName = 'task ' + process.pid + '.' + childProcess.pid
	        childProcess.stdout.on('data', function(data) {
	            console.log('['+ taskName + '] stdout: \n--------------------------------\n', data.toString());
	        });
	        childProcess.stderr.on('data', function(data) {
	            console.log('['+ taskName + '] stderr: ', data); 
	        });
	    })
	    .then(function(result) {
	         console.log('--------------------------------\n['+ taskName + '] done!');
	         return result;
	    })
	    .fail(function(err) {
	        console.error('['+ taskName + '] ERROR: ', err);
	    });
}


module.exports = Command;



